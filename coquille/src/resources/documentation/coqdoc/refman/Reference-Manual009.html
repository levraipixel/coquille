<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.09">
<LINK rel="stylesheet" type="text/css" href="Reference-Manual.css">
<TITLE>Proof handling</TITLE>
</HEAD>
<BODY >
<A HREF="Reference-Manual008.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A>
<A HREF="toc.html"><IMG SRC="contents_motif.gif" ALT="Up"></A>
<A HREF="Reference-Manual010.html"><IMG SRC="next_motif.gif" ALT="Next"></A>
<HR>
<H1 CLASS="chapter"><A NAME="htoc160">Chapter 7</A>  Proof handling</H1><P>
<A NAME="@default403"></A>
<A NAME="Proof-handling"></A></P><P>In <SPAN STYLE="font-variant:small-caps">Coq</SPAN>'s proof editing mode all top-level commands documented in 
chapter <A HREF="Reference-Manual008.html#Vernacular-commands">6</A> remain available
and the user has access to specialized commands dealing with proof
development pragmas documented in this section. He can also use some
other specialized commands called <EM>tactics</EM>. They are the very
tools allowing the user to deal with logical reasoning. They are
documented in chapter <A HREF="Reference-Manual010.html#Tactics">8</A>.<BR>
When switching in editing proof mode, the prompt
<A NAME="@default404"></A> 
<TT>Coq &lt;</TT> is changed into <I><FONT COLOR=maroon>ident</FONT></I><TT> &lt;</TT> where <I><FONT COLOR=maroon>ident</FONT></I> is the
declared name of the theorem currently edited.</P><P>At each stage of a proof development, one has a list of goals to
prove. Initially, the list consists only in the theorem itself. After
having applied some tactics, the list of goals contains the subgoals
generated by the tactics.</P><P>To each subgoal is associated a number of
hypotheses we call the <A NAME="@default405"><EM>local context</EM></A> of the goal.
Initially, the local context is empty. It is enriched by the use of
certain tactics (see mainly section <A HREF="Reference-Manual010.html#intro">8.3.5</A>).</P><P>When a proof is achieved the message <TT>Proof completed</TT> is
displayed. One can then store this proof as a defined constant in the
environment. Because there exists a correspondence between proofs and
terms of &#X3BB;-calculus, known as the <EM>Curry-Howard
isomorphism</EM> [<A HREF="biblio.html#How80"><CITE>70</CITE></A><CITE>, </CITE><A HREF="biblio.html#Bar91"><CITE>6</CITE></A><CITE>, </CITE><A HREF="biblio.html#Gir89"><CITE>66</CITE></A><CITE>, </CITE><A HREF="biblio.html#Hue89"><CITE>73</CITE></A>], <SPAN STYLE="font-variant:small-caps">Coq</SPAN>  stores proofs as
terms of <SPAN STYLE="font-variant:small-caps">Cic</SPAN>. Those terms are called <EM>proof
terms</EM><A NAME="@default406"></A>.</P><P>It is possible to edit several proofs at the same time: see section
<A HREF="#Resume">7.1.8</A></P><P><BR>
<B>Error message: </B>When one attempts to use a proof editing command out of the
proof editing mode, <SPAN STYLE="font-variant:small-caps">Coq</SPAN>  raises the error message : <TT>No focused
proof</TT><A NAME="@error38"></A>.</P><H2 CLASS="section"><A NAME="toc43"></A><A NAME="htoc161">7.1</A>  Switching on/off the proof editing mode</H2><H3 CLASS="subsection"><A NAME="htoc162">7.1.1</A>  <TT>Goal </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT></H3><P>
<A NAME="@default407"></A><A NAME="@command137"></A><A NAME="Goal"></A>
This command switches <SPAN STYLE="font-variant:small-caps">Coq</SPAN>  to editing proof mode and sets <I><FONT COLOR=maroon>form</FONT></I> as
the original goal. It associates the name <TT>Unnamed_thm</TT> to
that goal.</P><P><BR>
<B>Error messages: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>the term </TT><I><FONT COLOR=maroon>form</FONT></I><TT> has type &#X2026; which should be Set,
Prop or Type</TT><A NAME="@error39"></A>
</LI></OL><P><BR>
<B>See also: </B>section <A HREF="#Theorem">7.1.4</A></P><H3 CLASS="subsection"><A NAME="htoc163">7.1.2</A>  <TT>Qed.</TT></H3><P><A NAME="@default408"></A><A NAME="@command138"></A><A NAME="Qed"></A>
This command is available in interactive editing proof mode when the
proof is completed. Then <TT>Qed</TT> extracts a proof term from the
proof script, switches back to <SPAN STYLE="font-variant:small-caps">Coq</SPAN> top-level and attaches the
extracted proof term to the declared name of the original goal. This
name is added to the environment as an <TT>Opaque</TT> constant.</P><P><BR>
<B>Error messages: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>Attempt to save an incomplete proof</TT><A NAME="@error40"></A>
</LI><LI CLASS="li-enumerate">Sometimes an error occurs when building the proof term,
because tactics do not enforce completely the term construction
constraints.<P>The user should also be aware of the fact that since the proof term is
completely rechecked at this point, one may have to wait a while when
the proof is large. In some exceptional cases one may even incur a
memory overflow.
</P></LI></OL><P><BR>
<B>Variants: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate"><TT>Defined.</TT>
<A NAME="@default409"></A><A NAME="@command139"></A> 
<A NAME="Defined"></A> <P>Defines the proved term as a transparent constant.</P></LI><LI CLASS="li-enumerate"><TT>Save.</TT>
<A NAME="@default410"></A><A NAME="@command140"></A><P>Is equivalent to <TT>Qed</TT>.</P></LI><LI CLASS="li-enumerate"><TT>Save </TT><I><FONT COLOR=maroon>ident</FONT></I><TT>.</TT><P>Forces the name of the original goal to be <I><FONT COLOR=maroon>ident</FONT></I>. This command
(and the following ones) can only be used if the original goal has
been opened using the <TT>Goal</TT> command.</P></LI><LI CLASS="li-enumerate"><TT>Save Theorem </TT><I><FONT COLOR=maroon>ident</FONT></I><TT>.</TT><BR>
 <TT>Save Lemma </TT><I><FONT COLOR=maroon>ident</FONT></I><TT>.</TT><BR>
 <TT>Save Remark </TT><I><FONT COLOR=maroon>ident</FONT></I><TT>.</TT><BR>
 <TT>Save Fact </TT><I><FONT COLOR=maroon>ident</FONT></I><TT>.</TT><P>Are equivalent to <TT>Save </TT><I><FONT COLOR=maroon>ident</FONT></I><TT>.</TT> 
</P></LI></OL><H3 CLASS="subsection"><A NAME="htoc164">7.1.3</A>  <TT>Admitted.</TT></H3><P><A NAME="@default411"></A><A NAME="@command141"></A><A NAME="Admitted"></A>
This command is available in interactive editing proof mode to give up
the current proof and declare the initial goal as an axiom.</P><H3 CLASS="subsection"><A NAME="htoc165">7.1.4</A>  <TT>Theorem </TT><I><FONT COLOR=maroon>ident</FONT></I><TT> : </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT></H3><P>
<A NAME="@default412"></A><A NAME="@command142"></A>
<A NAME="Theorem"></A></P><P>This command switches to interactive editing proof mode and declares
<I><FONT COLOR=maroon>ident</FONT></I> as being the name of the original goal <I><FONT COLOR=maroon>form</FONT></I>. When declared
as a <TT>Theorem</TT>, the name <I><FONT COLOR=maroon>ident</FONT></I> is known at all section levels:
<TT>Theorem</TT> is a <I><FONT COLOR=maroon>global</FONT></I> lemma.</P><P><BR>
<B>Error messages: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate"><TT>the term </TT><I><FONT COLOR=maroon>form</FONT></I><TT> has type &#X2026; which should be Set,
Prop or Type</TT><A NAME="@error41"></A></LI><LI CLASS="li-enumerate"><I><FONT COLOR=maroon>ident</FONT></I><TT>already exists</TT><A NAME="@error42"></A><P>The name you provided already defined. You have then to choose
another name.</P></LI></OL><P><BR>
<B>Variants: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate"><TT>Lemma </TT><I><FONT COLOR=maroon>ident</FONT></I><TT> : </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT>
<A NAME="@default413"></A><A NAME="@command143"></A><P>It is equivalent to <TT>Theorem </TT><I><FONT COLOR=maroon>ident</FONT></I><TT> : </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT></P></LI><LI CLASS="li-enumerate"><TT>Remark </TT><I><FONT COLOR=maroon>ident</FONT></I><TT> : </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT><A NAME="@default414"></A><A NAME="@command144"></A><BR>
 <TT>Fact </TT><I><FONT COLOR=maroon>ident</FONT></I><TT> : </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT><A NAME="@default415"></A><A NAME="@command145"></A><P>Used to have a different meaning, but are now equivalent to <TT>Theorem </TT><I><FONT COLOR=maroon>ident</FONT></I><TT> : </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT> They are kept for compatibility.</P></LI><LI CLASS="li-enumerate"><TT>Definition </TT><I><FONT COLOR=maroon>ident</FONT></I><TT> : </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT>
<A NAME="@default416"></A><A NAME="@command146"></A><P>Analogous to <TT>Theorem</TT>, intended to be used in conjunction with
<TT>Defined</TT> (see <A HREF="#Defined">1</A>) in order to define a
transparent constant.</P></LI><LI CLASS="li-enumerate"><TT>Let </TT><I><FONT COLOR=maroon>ident</FONT></I><TT> : </TT><I><FONT COLOR=maroon>form</FONT></I><TT>.</TT>
<A NAME="@default417"></A><A NAME="@command147"></A><P>Analogous to <TT>Definition</TT> except that the definition is turned
into a local definition on objects depending on it after closing the
current section.
</P></LI></OL><H3 CLASS="subsection"><A NAME="htoc166">7.1.5</A>  <TT>Proof </TT><I><FONT COLOR=maroon>term</FONT></I><TT>.</TT></H3><P>
<A NAME="@default418"></A><A NAME="@command148"></A>
<A NAME="BeginProof"></A>
This command applies in proof editing mode. It is equivalent to <TT>exact </TT><I><FONT COLOR=maroon>term</FONT></I><TT>; Save.</TT> That is, you have to give the full proof in
one gulp, as a proof term (see section <A HREF="Reference-Manual010.html#exact">8.2.1</A>).</P><P><BR>
<B>Variant: </B><TT>Proof.</TT></P><P>Is a noop which is useful to delimit the sequence of tactic commands
which start a proof, after a <TT>Theorem</TT> command. It is a good
practice to use <TT>Proof.</TT> as an opening parenthesis, closed in
the script with a closing <TT>Qed.</TT></P><P><BR>
<B>See also: </B><TT>Proof with </TT><I><FONT COLOR=maroon>tactic</FONT></I><TT>.</TT> in section <A HREF="Reference-Manual010.html#ProofWith">8.13.6</A>.</P><H3 CLASS="subsection"><A NAME="htoc167">7.1.6</A>  <TT>Abort.</TT></H3><P>
<A NAME="@default419"></A><A NAME="@command149"></A></P><P>This command cancels the current proof development, switching back to
the previous proof development, or to the <SPAN STYLE="font-variant:small-caps">Coq</SPAN> toplevel if no other
proof was edited.</P><P><BR>
<B>Error messages: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>No focused proof (No proof-editing in progress)</TT><A NAME="@error43"></A>
</LI></OL><P><BR>
<B>Variants: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate"><TT>Abort </TT><I><FONT COLOR=maroon>ident</FONT></I><TT>.</TT><P>Aborts the editing of the proof named <I><FONT COLOR=maroon>ident</FONT></I>.</P></LI><LI CLASS="li-enumerate"><TT>Abort All.</TT><P>Aborts all current goals, switching back to the <SPAN STYLE="font-variant:small-caps">Coq</SPAN> toplevel.</P></LI></OL><H3 CLASS="subsection"><A NAME="htoc168">7.1.7</A>  <TT>Suspend.</TT></H3><P>
<A NAME="@default420"></A><A NAME="@command150"></A></P><P>This command applies in proof editing mode. It switches back to the
<SPAN STYLE="font-variant:small-caps">Coq</SPAN> toplevel, but without canceling the current proofs.</P><H3 CLASS="subsection"><A NAME="htoc169">7.1.8</A>  <TT>Resume.</TT></H3><P>
<A NAME="@default421"></A><A NAME="@command151"></A><A NAME="Resume"></A></P><P>This commands switches back to the editing of the last edited proof.</P><P><BR>
<B>Error messages: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>No proof-editing in progress</TT><A NAME="@error44"></A>
</LI></OL><P><BR>
<B>Variants: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate"><TT>Resume </TT><I><FONT COLOR=maroon>ident</FONT></I><TT>.</TT><P>Restarts the editing of the proof named <I><FONT COLOR=maroon>ident</FONT></I>. This can be used
to navigate between currently edited proofs.</P></LI></OL><P><BR>
<B>Error messages: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>No such proof</TT><A NAME="@error45"></A>
</LI></OL><H2 CLASS="section"><A NAME="toc44"></A><A NAME="htoc170">7.2</A>  Navigation in the proof tree</H2><H3 CLASS="subsection"><A NAME="htoc171">7.2.1</A>  <TT>Undo.</TT></H3><P>
<A NAME="@default422"></A><A NAME="@command152"></A></P><P>This command cancels the effect of the last tactic command. Thus, it
backtracks one step.</P><P><BR>
<B>Error messages: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>No focused proof (No proof-editing in progress)</TT><A NAME="@error46"></A>
</LI><LI CLASS="li-enumerate"><TT>Undo stack would be exhausted</TT><A NAME="@error47"></A>
</LI></OL><P><BR>
<B>Variants: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate"><TT>Undo </TT><I><FONT COLOR=maroon>num</FONT></I><TT>.</TT><P>Repeats <TT>Undo</TT> <I><FONT COLOR=maroon>num</FONT></I> times.</P></LI></OL><H3 CLASS="subsection"><A NAME="htoc172">7.2.2</A>  <TT>Set Undo </TT><I><FONT COLOR=maroon>num</FONT></I><TT>.</TT></H3><P>
<A NAME="@default423"></A><A NAME="@command153"></A></P><P>This command changes the maximum number of <TT>Undo</TT>'s that will be
possible when doing a proof. It only affects proofs started after
this command, such that if you want to change the current undo limit
inside a proof, you should first restart this proof.</P><H3 CLASS="subsection"><A NAME="htoc173">7.2.3</A>  <TT>Unset Undo.</TT></H3><P>
<A NAME="@default424"></A><A NAME="@command154"></A></P><P>This command resets the default number of possible <TT>Undo</TT> commands
(which is currently 12).</P><H3 CLASS="subsection"><A NAME="htoc174">7.2.4</A>  <TT>Restart.</TT></H3><P><A NAME="@default425"></A><A NAME="@command155"></A>
This command restores the proof editing process to the original goal.</P><P><BR>
<B>Error messages: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>No focused proof to restart</TT><A NAME="@error48"></A>
</LI></OL><H3 CLASS="subsection"><A NAME="htoc175">7.2.5</A>  <TT>Focus.</TT></H3><P><A NAME="@default426"></A><A NAME="@command156"></A>
This focuses the attention on the first subgoal to prove and the printing
of the other subgoals is suspended until the focused subgoal is
solved or unfocused. This is useful when there are many current
subgoals which clutter your screen.</P><P><BR>
<B>Variant: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>Focus </TT><I><FONT COLOR=maroon>num</FONT></I><TT>.</TT><BR>
This focuses the attention on the <I><FONT COLOR=maroon>num</FONT></I><SUP><FONT SIZE=2><I>th</I></FONT></SUP> subgoal to prove.</LI></OL><H3 CLASS="subsection"><A NAME="htoc176">7.2.6</A>  <TT>Unfocus.</TT></H3><P><A NAME="@default427"></A><A NAME="@command157"></A>
Turns off the focus mode.</P><H2 CLASS="section"><A NAME="toc45"></A><A NAME="htoc177">7.3</A>  Displaying information</H2><H3 CLASS="subsection"><A NAME="htoc178">7.3.1</A>  <TT>Show.</TT></H3><P><A NAME="@default428"></A><A NAME="@command158"></A><A NAME="Show"></A>
This command displays the current goals.</P><P><BR>
<B>Variants: </B></P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
<TT>Show </TT><I><FONT COLOR=maroon>num</FONT></I><TT>.</TT><BR>
 Displays only the <I><FONT COLOR=maroon>num</FONT></I>-th subgoal.<BR>
<BR>
<B>Error messages: </B><OL CLASS="enumerate" type=a><LI CLASS="li-enumerate">
<TT>No such goal</TT><A NAME="@error49"></A>
</LI><LI CLASS="li-enumerate"><TT>No focused proof</TT><A NAME="@error50"></A>
</LI></OL></LI><LI CLASS="li-enumerate"><TT>Show Implicits.</TT><A NAME="@default429"></A><A NAME="@command159"></A><BR>
 Displays the current goals, printing the implicit arguments of
constants.</LI><LI CLASS="li-enumerate"><TT>Show Implicits </TT><I><FONT COLOR=maroon>num</FONT></I><TT>.</TT><BR>
 Same as above, only displaying the <I><FONT COLOR=maroon>num</FONT></I>-th subgoal.</LI><LI CLASS="li-enumerate"><TT>Show Script.</TT><A NAME="@default430"></A><A NAME="@command160"></A><BR>
 Displays the whole list of tactics applied from the beginning
of the current proof. 
This tactics script may contain some holes (subgoals not yet proved).
They are printed under the form <CODE>&lt;Your Tactic Text here&gt;</CODE>.</LI><LI CLASS="li-enumerate"><TT>Show Tree.</TT><A NAME="@default431"></A><A NAME="@command161"></A><BR>
This command can be seen as a more structured way of
displaying the state of the proof than that 
provided by <TT>Show Script</TT>. Instead of just giving
the list of tactics that have been applied, it 
shows the derivation tree constructed by then. 
Each node of the tree contains the conclusion
of the corresponding sub-derivation (i.e. a
goal with its corresponding local context) and 
the tactic that has generated all the 
sub-derivations. The leaves of this tree are
the goals which still remain to be proved.</LI><LI CLASS="li-enumerate"><TT>Show Proof.</TT><A NAME="@default432"></A><A NAME="@command162"></A><BR>
It displays the proof term generated by the 
tactics that have been applied. 
If the proof is not completed, this term contain holes,
which correspond to the sub-terms which are still to be 
constructed. These holes appear as a question mark indexed 
by an integer, and applied to the list of variables in 
the context, since it may depend on them. 
The types obtained by abstracting away the context from the
type of each hole-placer are also printed.</LI><LI CLASS="li-enumerate"><TT>Show Conjectures.</TT><A NAME="@default433"></A><A NAME="@command163"></A><BR>
It prints the list of the names of all the theorems that 
are currently being proved.
As it is possible to start proving a previous lemma during
the proof of a theorem, this list may contain several 
names. </LI><LI CLASS="li-enumerate"><TT>Show Intro.</TT><A NAME="@default434"></A><A NAME="@command164"></A><BR>
If the current goal begins by at least one product, this command
prints the name of the first product, as it would be generated by 
an anonymous <TT>Intro</TT>. The aim of this command is to ease the
writing of more robust scripts. For example, with an appropriate 
Proof General macro, it is possible to transform any anonymous <TT>Intro</TT> into a qualified one such as <TT>Intro y13</TT>.
In the case of a non-product goal, it prints nothing. </LI><LI CLASS="li-enumerate"><TT>Show Intros.</TT><A NAME="@default435"></A><A NAME="@command165"></A><BR>
This command is similar to the previous one, it simulates the naming 
process of an <TT>Intros</TT>.</LI></OL><H3 CLASS="subsection"><A NAME="htoc179">7.3.2</A>  <TT>Set Hyps Limit </TT><I><FONT COLOR=maroon>num</FONT></I><TT>.</TT></H3><P>
<A NAME="@default436"></A><A NAME="@command166"></A>
This command sets the maximum number of hypotheses displayed in
goals after the application of a tactic. 
All the hypotheses remains usable in the proof development.</P><H3 CLASS="subsection"><A NAME="htoc180">7.3.3</A>  <TT>Unset Hyps Limit.</TT></H3><P>
<A NAME="@default437"></A><A NAME="@command167"></A>
This command goes back to the default mode which is to print all
available hypotheses.</P><H2 CLASS="section"><A NAME="toc46"></A><A NAME="htoc181">7.4</A>  <I>DPL</I> : A Declarative proof language for Coq <EM>(experimental)</EM> </H2><P>An implementation of the <I>DPL</I> declarative proof language by Pierre Corbineau at the Radboud University Nijmegen (The Netherlands) is included in Coq.</P><P>Due to the experimental nature and hence the potentially unstable semantics of the language, its documentation is not included here. However, it can be found at :</P><P><TT>http://www.cs.ru.nl/~corbineau/mmode.html</TT></P><HR>
<A HREF="Reference-Manual008.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A>
<A HREF="toc.html"><IMG SRC="contents_motif.gif" ALT="Up"></A>
<A HREF="Reference-Manual010.html"><IMG SRC="next_motif.gif" ALT="Next"></A>
</BODY>
</HTML>
